---
title: Uso avançado
sidebar:
  order: 2
---

import { Aside } from "@astrojs/starlight/components";
import ImgFrame from "@components/ImgFrame.astro";

Nesta página, você vai aprender a utilizar os fragmentos de forma mais avançada, combinando parâmetros na composição de seus valores.

<Aside type="caution">

Antes de prosseguir, é importante entender o que é um fragmento e como utilizar.

Para entender, leia [O que é um fragmento](/fragments/understand/).

</Aside>

## Utilização avançada

Os **fragmentos** foram criados inicialmente para resolver um problema específico: a impossibilidade de realizar otimizações no Backtest do MetaTrader 5. Com o tempo, eles foram aprimorados e hoje não apenas superam essa limitação, mas também contribuem para acelerar o desenvolvimento e o reaproveitamento do código.

Com o suporte a parâmetros, os fragmentos passaram a se comportar de forma semelhante a funções, com a diferença de que atuam no momento da inicialização, injetando código diretamente no fluxo da expressão lógica.

### Parametrização

Uma das principais novidades é a possibilidade de usar parâmetros na composição de fragmentos do tipo **STRING**, transformando-os em uma espécie de função constante. Isso permite alterar o comportamento do fragmento conforme os parâmetros passados, deixando a expressão um pouco mais dinâmica.

### Definição do fragmento

Vamos definir o fragmento **STR0** com o seguinte valor: `ALL_PROFIT_OPEN >= @0 && @1`. <br/>
O caracter `@` indica que será um parametro e `0` e `1` indicam os indices dos parâmetros. O indice deve ser maior ou igual a zero, sendo zero o primeiro parâmetro.

<ImgFrame>![Fragmentos](@src/assets/StrParam.png)</ImgFrame>

### Uso sem parâmetros

Abaixo está um exemplo de uso do fragmento sem parâmetros:

```java
CLOSE[0] > CLOSE[1] && STR0
```

O fragmento **STR0** será automaticamente convertido para `CLOSE[0] > CLOSE[1] && ALL_PROFIT_OPEN >= @0 && @1`, o que causará um erro na compilação da expressão lógica devido à ausência dos parâmetros necessários. Esse erro acontece porque, na definição do fragmento, os parâmetros `@0` e `@1` foram declarados como obrigatórios.

### Uso com parâmetros

Abaixo está um exemplo de uso do fragmento com parâmetros:

```java
CLOSE[0] > CLOSE[1] && STR0[50, Print["My age is: ", INT0]]
```

O fragmento **STR0** será convertido para `CLOSE[0] > CLOSE[1] && ALL_PROFIT_OPEN >= 50 && Print["My age is: ", INT0]`. Nenhum erro ocorrerá, pois todos os parâmetros foram fornecidos corretamente.

De modo geral, o uso de parâmetros permite criar expressões mais complexas e flexíveis. Além disso, possibilita modificar o comportamento da expressão de forma dinâmica, conforme os valores passados.
